<html>

<head>
<script src="http://code.jquery.com/jquery.min.js"></script>
<script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
<script src="SilverLight.js"></script>
<script>
var bing_key = "dummy";
var map = null;

      function GetMap()
      {  

         map = new Microsoft.Maps.Map(document.getElementById("mapDiv"), {credentials: bing_key});

      }
      function SetLoc (lat, long){

        map.setView({center:new Microsoft.Maps.Location(lat, long)});

      }

      function SetLocation()
      {
         // Parse the input string
         var latLongArray = (document.getElementById("txtlatlong").value).split(",");

         // Retrieve the latitude and longitude values- normalize the longitude value
         var latVal = parseInt(latLongArray[0]);
         var longVal = Microsoft.Maps.Location.normalizeLongitude(parseInt(latLongArray[1]));

         // Set the map center
         // 17 = really really close
          Microsoft.Maps.registerModule("SLStreetsideModule", "scripts/SLStreetsideModule.js", { styleURLs: ["styles/SLStreetsideModule.css"] });
            Microsoft.Maps.loadModule("SLStreetsideModule", { callback: function () {
                slMap = new SLStreetsideModule(map);
            } 
            });
         map.setView({center:new Microsoft.Maps.Location(latVal, longVal),zoom: 8 });

      }
</script>
<style>
.Active, .LogoSearchContainer{
  display:none;
}

</style>
</head>
<body>
  <div id="info">
  </div>

 <div id='mapDiv' style="position:relative; width:300px; height:300px;"></div> 
      Latitude, Longitude: <input id="txtlatlong" type="text" value="40, -120"/>
      <input type="button" value="Set center location" onclick="SetLocation();"/>

</body>



<script>


//GetMap();

/*


https://raw.githubusercontent.com/va-data/va-resources/master/homeless-assistance.json
https://raw.githubusercontent.com/va-data/va-facilities/master/facilities.json
https://raw.githubusercontent.com/va-data/va-resources/master/family-caregiver-support.json
https://api.data.gov/gsa/fbopen/v0/opps?q=accounting&api_key=XcatBp9s9TBuL1VT047HE6yqxPxPIpIbuktyvrnj


*/

var jobs = function (data){




}
function facilities(data){
  console.log(data);
  data = data["facilities"];

  for (var i =0 ; i < data.length; i++){
    ele = data[i];
    d = document.createElement("div");

    a = document.createElement("a");
    a.href = ele["url"];
    a.innerHTML = ele["url"];
    $(a).appendTo(d);
    console.log(ele);
    title = document.createElement("h2");
    title.innerHTML=ele["name"].replace(/<\/?[^>]+(>|$)/g, " ");

    address = document.createElement("p");
    address.innerHTML= String(ele["address"] + " "+ ele["city"] + ", "  + ele["state"]).replace(/<\/?[^>]+(>|$)/g, "");

    type = document.createElement("p");
    type.innerHTML=ele["type"].replace(/<\/?[^>]+(>|$)/g, " ");

    description = document.createElement("p")
    description.innerHTML=ele["description"].replace(/<\/?[^>]+(>|$)/g, " ");;//replace(/<\/?[^>]+(>|$)/g, " ");


    

    n = "ele ele" + i;
    $(title).addClass(n).appendTo(d);
    $(address).addClass(n).appendTo(d);
    $(type).addClass(n).appendTo(d);
    $(description).addClass(n).appendTo(d);    
    $(d).addClass(n).appendTo("#info");

  }

}
function getVData(url,parser){
  var stuff, data, success;
   $.ajax({
    dataType: "json",
    url: url,
    data: data,
    success: function(data){
     // console.log(data);
      parser(data);
      
      //stuff = data;
    }
  });
}

function care (data){
  console.log(data);
  for (var i =0 ; i < data.length; i++){
    ele = data[i];
    d = document.createElement("div");

    a = document.createElement("a");
    a.href=data[i]["linkName"];
    a.innerHTML = data[i]["linkName"];
    $(a).appendTo(d);

    title = document.createElement("h2");
    title.innerHTML = ele["title"];
    linkName = document.createElement("span");
    linkName.innerHTML = ele["linkName"];
    content = document.createElement("span");
    content.innerHTML = ele["content"].replace(/<\/?[^>]+(>|$)/g, " ");;

    $(title).appendTo(d);
    $(linkName).appendTo(d);
    $(content).appendTo(d);


    $(d).addClass("ele").appendTo("#info");

  }



}
'''
RUN THE BELOW COMMANDS TO PARSE FILE AND INSERT RESULTS INTO HTML FILE

getVData("https://raw.githubusercontent.com/va-data/va-resources/master/homeless-assistance.json", care);
getVData("https://raw.githubusercontent.com/va-data/va-resources/master/family-caregiver-support.json", care);
getVData("https://raw.githubusercontent.com/va-data/va-facilities/master/facilities.json", facilities);

'''


//console.log(getVData("https://api.data.gov/gsa/fbopen/v0/opps?q=accounting&api_key=XcatBp9s9TBuL1VT047HE6yqxPxPIpIbuktyvrnj"), jobs);
//console.log(getVData("https://api.data.gov/gsa/fbopen/v0/opps?q=accounting&api_key=XcatBp9s9TBuL1VT047HE6yqxPxPIpIbuktyvrnj"));

//console.log(data);
/*

$.getJSON( "https://api.data.gov/gsa/fbopen/v0/opps?q=accounting&api_key=XcatBp9s9TBuL1VT047HE6yqxPxPIpIbuktyvrnj", function( data ) {
	console.log(data);
  var items = [];
  $.each( data, function( key, val ) {
    items.push( "<li id='" + key + "'>" + val + "</li>" );
  });
 
  $( "<ul/>", {
    "class": "my-new-list",
    html: items.join( "" )
  }).appendTo( "body" );
});
*/

</script>

</html>